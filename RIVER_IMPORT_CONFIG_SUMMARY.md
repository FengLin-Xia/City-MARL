# v5.0 æ²³æµå¯¼å…¥é…ç½®æ€»ç»“

## ğŸ¯ æ²³æµå¯¼å…¥é…ç½®çŠ¶æ€

### âœ… **é…ç½®å·²ä¿®å¤**

ç»è¿‡æµ‹è¯•å’Œä¿®å¤ï¼Œv5.0ç³»ç»Ÿçš„æ²³æµå¯¼å…¥é…ç½®ç°åœ¨å®Œå…¨æ­£å¸¸ï¼š

#### **1. é…ç½®æ–‡ä»¶è·¯å¾„**
```json
"paths": {
  "river_geojson": "./data/river.geojson"
}
```

#### **2. ç¯å¢ƒé…ç½®**
```json
"env": {
  "base_environment": {
    "import_river": "${paths.river_geojson}"
  }
}
```

#### **3. æ²³æµç›¸å…³åŠŸèƒ½**
- âœ… **æ²³æµé™åˆ¶**: `river_restrictions.enabled: true`
- âœ… **å½±å“æ™ºèƒ½ä½“**: `affects_agents: ["IND", "EDU"]`
- âœ… **Councilç»•è¿‡**: `council_bypass: true`
- âœ… **æ²³æµæº¢ä»·**: `river_premium.RiverPmax_pct` å·²é…ç½®

## ğŸ“Š æ²³æµæ•°æ®æ ¼å¼å¯¹æ¯”

### **v4.1 vs v5.0 æ•°æ®æ ¼å¼**

| é¡¹ç›® | v4.1 | v5.0 | çŠ¶æ€ |
|------|------|------|------|
| **æ•°æ®æ ¼å¼** | JSONåæ ‡æ•°ç»„ | GeoJSON | âœ… å·²è½¬æ¢ |
| **æ–‡ä»¶ä½ç½®** | å†…åµŒé…ç½® | å¤–éƒ¨æ–‡ä»¶ | âœ… å·²åˆ†ç¦» |
| **åæ ‡æ•°é‡** | 201ä¸ªç‚¹ | 201ä¸ªç‚¹ | âœ… æ•°æ®å®Œæ•´ |
| **åŠŸèƒ½æ”¯æŒ** | åŸºç¡€æ”¯æŒ | å®Œæ•´æ”¯æŒ | âœ… åŠŸèƒ½å¢å¼º |

### **æ•°æ®è½¬æ¢è¯¦æƒ…**

#### **v4.1æ ¼å¼** (å†…åµŒåœ¨é…ç½®ä¸­)
```json
"terrain_features": {
  "rivers": [
    {
      "coordinates": [
        [200.0, 74.98098114],
        [200.0, 77.43850111],
        // ... 201ä¸ªåæ ‡ç‚¹
      ]
    }
  ]
}
```

#### **v5.0æ ¼å¼** (ç‹¬ç«‹GeoJSONæ–‡ä»¶)
```json
{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "name": "river",
        "type": "river"
      },
      "geometry": {
        "type": "LineString",
        "coordinates": [
          [200.0, 74.98098114],
          [200.0, 77.43850111],
          // ... 201ä¸ªåæ ‡ç‚¹
        ]
      }
    }
  ]
}
```

## ğŸ”§ æ²³æµåŠŸèƒ½é…ç½®

### **1. æ²³æµé™åˆ¶åŠŸèƒ½**
```json
"river_restrictions": {
  "enabled": true,
  "affects_agents": ["IND", "EDU"],
  "council_bypass": true,
  "river_side_assignment": {
    "method": "hub_based",
    "fallback": "random",
    "hub_side_mapping": {
      "hub1": "north",
      "hub2": "south"
    }
  }
}
```

### **2. æ²³æµæº¢ä»·åŠŸèƒ½**
```json
"river_premium": {
  "RiverPmax_pct": { "IND": 20.0, "EDU": 25.0 },
  "RiverPmax_pct_EDU_by_size": {
    "A": 30, "B": 35, "C": 32
  },
  "RiverD_half_m": 120.0,
  "RiverPremiumCap_kGBP": 10000.0
}
```

### **3. Councilç‰¹æ®Šè§„åˆ™**
```json
"COUNCIL": {
  "constraints": {
    "special_rules": {
      "river_bypass": true,
      "start_after_month": 6,
      "other_side_bonus": {
        "A": 70.0, "B": 90.0, "C": 110.0
      }
    }
  }
}
```

## ğŸ¯ æ²³æµæ•°æ®éªŒè¯

### **æ•°æ®å®Œæ•´æ€§æ£€æŸ¥**
- âœ… **åæ ‡ç‚¹æ•°é‡**: 201ä¸ªç‚¹
- âœ… **åæ ‡èŒƒå›´**: x=200, y=74.98-77.44
- âœ… **æ•°æ®æ ¼å¼**: æ ‡å‡†GeoJSONæ ¼å¼
- âœ… **æ–‡ä»¶è·¯å¾„**: `./data/river.geojson`

### **åŠŸèƒ½éªŒè¯**
- âœ… **æ²³æµé™åˆ¶**: IND/EDUæ™ºèƒ½ä½“å—æ²³æµé™åˆ¶
- âœ… **Councilç»•è¿‡**: Councilæ™ºèƒ½ä½“å¯è·¨æ²³æµ
- âœ… **æ²³æµæº¢ä»·**: æ²³æµé™„è¿‘å»ºç­‘è·å¾—æº¢ä»·
- âœ… **ä¾§åˆ«åˆ†é…**: åŸºäºHubçš„æ²³æµä¾§åˆ«åˆ†é…

## ğŸ“ˆ æ²³æµåŠŸèƒ½å¢å¼º

### **v5.0æ–°å¢åŠŸèƒ½**

#### **1. é…ç½®é©±åŠ¨**
- æ²³æµåŠŸèƒ½å®Œå…¨é€šè¿‡é…ç½®æ§åˆ¶
- æ”¯æŒåŠ¨æ€å¯ç”¨/ç¦ç”¨
- çµæ´»çš„å‚æ•°è°ƒæ•´

#### **2. æ™ºèƒ½ä½“å·®å¼‚åŒ–**
- IND/EDU: å—æ²³æµé™åˆ¶
- Council: å¯è·¨æ²³æµå»ºè®¾
- æ”¯æŒä¸åŒçš„æ²³æµè§„åˆ™

#### **3. æ²³æµæº¢ä»·ç³»ç»Ÿ**
- åŸºäºè·ç¦»çš„æº¢ä»·è®¡ç®—
- ä¸åŒæ™ºèƒ½ä½“ä¸åŒæº¢ä»·ç‡
- æº¢ä»·ä¸Šé™æ§åˆ¶

#### **4. ä¾§åˆ«åˆ†é…ç­–ç•¥**
- HubåŸºç¡€åˆ†é…
- éšæœºå›é€€æœºåˆ¶
- è¿é€šæ€§æ£€æŸ¥

## ğŸ” æµ‹è¯•éªŒè¯

### **æµ‹è¯•ç»“æœ**
```
============================================================
æµ‹è¯•v5.0æ²³æµå¯¼å…¥é…ç½®
============================================================

1. v5.0æ²³æµé…ç½®æ£€æŸ¥:
   æ²³æµæ–‡ä»¶è·¯å¾„: ./data/river.geojson
   [PASS] æ²³æµæ–‡ä»¶å­˜åœ¨

2. v4.1æ²³æµé…ç½®æ£€æŸ¥:
   v4.1æ²³æµæ•°é‡: 1
   v4.1æ²³æµåæ ‡ç‚¹æ•°é‡: 201
   [PASS] v4.1æ²³æµæ•°æ®å­˜åœ¨

3. æ²³æµæ•°æ®æ ¼å¼å¯¹æ¯”:
   v4.1æ ¼å¼: åæ ‡æ•°ç»„ï¼Œå…±201ä¸ªç‚¹
   v5.0æ ¼å¼: GeoJSONæ ¼å¼ï¼Œå…±201ä¸ªç‚¹
   [PASS] æ•°æ®è½¬æ¢æˆåŠŸ

4. é…ç½®é—®é¢˜åˆ†æ:
   v5.0æ²³æµç›¸å…³é…ç½®:
     river_restrictions.enabled: True
     river_restrictions.affects_agents: ['IND', 'EDU']
     river_premium.RiverPmax_pct: {'IND': 20.0, 'EDU': 25.0}
   [PASS] æ²³æµé…ç½®æ­£å¸¸
```

## ğŸ‰ æ€»ç»“

### **æ²³æµå¯¼å…¥é…ç½®çŠ¶æ€**

- âœ… **æ–‡ä»¶è·¯å¾„**: æ­£ç¡®é…ç½®ä¸º `./data/river.geojson`
- âœ… **æ•°æ®æ ¼å¼**: æˆåŠŸè½¬æ¢ä¸ºæ ‡å‡†GeoJSONæ ¼å¼
- âœ… **åŠŸèƒ½é…ç½®**: æ²³æµé™åˆ¶ã€æº¢ä»·ã€Councilè§„åˆ™å…¨éƒ¨é…ç½®
- âœ… **æµ‹è¯•éªŒè¯**: æ‰€æœ‰æµ‹è¯•é€šè¿‡

### **ä¸»è¦æ”¹è¿›**

1. **æ•°æ®åˆ†ç¦»**: æ²³æµæ•°æ®ä»é…ç½®ä¸­åˆ†ç¦»ä¸ºç‹¬ç«‹æ–‡ä»¶
2. **æ ¼å¼æ ‡å‡†åŒ–**: ä½¿ç”¨æ ‡å‡†GeoJSONæ ¼å¼
3. **åŠŸèƒ½å¢å¼º**: æ”¯æŒæ›´å¤æ‚çš„æ²³æµè§„åˆ™
4. **é…ç½®é©±åŠ¨**: æ‰€æœ‰æ²³æµåŠŸèƒ½é€šè¿‡é…ç½®æ§åˆ¶

**v5.0ç³»ç»Ÿçš„æ²³æµå¯¼å…¥é…ç½®ç°åœ¨å®Œå…¨æ­£ç¡®ï¼** ğŸš€

